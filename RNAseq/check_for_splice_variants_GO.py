#! /usr/bin/python
# 
# This script reads a txt file containing information on annotations (here,
# Bstricta_278_v1.2.annotation_info.txt) and prints the genes, where GO terms
# have not been found to be equal to their splice variants.

# in /home/mschilling/Desktop/gbs15/gbs_tools_ms/
# Usage: ./check_splice_variants_GO.py /home/mschilling/Desktop/stricta/stricta_transcriptome/v1.2/annotation/Bstricta_278_v1.2.annotation_info.txt



import sys
import re
import shutil
#import tempfile

########

#newfile = open(sys.argv[2], 'a')
infile = open(sys.argv[1],'r')
no_go_info = int()
diff_go = int()
gene_no = int()
splice_no = int()
for line in enumerate(infile):
    id = str(line).split('\\t')[2]
    go = str(line).split('\\t')[9]
    #print id, go
    gene = re.findall('[A-Z]+[a-z]+\.[0-9]+s[0-9]+', id)
    splice_var_no = re.findall('\.[0-9]+', id)[1]
    if splice_var_no == '.1':
        gene_no += 1
        splice_var_1 = gene
        go_1 = go
    else: 
        splice_no += 1
        if go == '' or go_1 == '':
            no_go_info +=1
        elif go == go_1:
            #print go, str('\t'), go_1
            continue
        else:
            print str('#'), go, str('\t'), go_1
            diff_go += 1

print str('total number of genes:'), gene_no
print str('total number of splice variants:'), splice_no
print str('genes without GO terms:'), no_go_info
print str('genes with different GO terms:'), diff_go


# don't compare if go == '' or go_1 == ''
# 

infile.close()
#newfile.close()



# GO:0003677,GO:0003916,GO:0006265,GO:0005694 	GO:0003677,GO:0003916,GO:0006265,GO:0005694,GO:0008270
# GO:0003676,GO:0004386,GO:0005524 	GO:0003676,GO:0004386,GO:0005524,GO:0016817
# GO:0004672,GO:0005524,GO:0006468,GO:0048544,GO:0004674 	GO:0048544,GO:0004672,GO:0006468,GO:0004674
# GO:0005515,GO:0008060,GO:0008270,GO:0032312 	GO:0005515,GO:0008060,GO:0008270,GO:0032312,GO:0005737
# GO:0016491,GO:0055114 	GO:0009055,GO:0051536,GO:0016491,GO:0055114
# GO:0016491,GO:0055114 	GO:0009055,GO:0051536,GO:0016491,GO:0055114
# GO:0000228 	GO:0000228,GO:0005515
# GO:0000166,GO:0004812,GO:0005524,GO:0006418 	GO:0000166,GO:0004812,GO:0005524,GO:0006418,GO:0004828,GO:0006434,GO:0005737
# GO:0003700,GO:0006355,GO:0005634 	GO:0003677,GO:0046983,GO:0003700,GO:0006355,GO:0005634
# GO:0004672,GO:0006468 	GO:0005515,GO:0004672,GO:0006468
# GO:0004672,GO:0006468 	GO:0005515,GO:0004672,GO:0006468
# GO:0004672,GO:0006468 	GO:0005515,GO:0004672,GO:0006468
# GO:0004672,GO:0005524,GO:0006468 	GO:0004672,GO:0005524,GO:0006468,GO:0005515
# GO:0000287,GO:0010333,GO:0016829 	GO:0010333,GO:0016829,GO:0008152,GO:0000287
# GO:0005515 	GO:0008270,GO:0005622,GO:0005515
# GO:0043531,GO:0005515,GO:0007165 	GO:0005515,GO:0043531,GO:0007165
# GO:0005525 	GO:0005525,GO:0015093,GO:0015684,GO:0016021
# GO:0005515 	GO:0005515,GO:0043531
# GO:0005515 	GO:0005515,GO:0043531
# GO:0042254,GO:0005622 	GO:0003735,GO:0006414,GO:0005622,GO:0005840,GO:0042254
# GO:0003676,GO:0004386,GO:0005524 	GO:0003676,GO:0005524,GO:0008026
# GO:0003676,GO:0004386,GO:0005524 	GO:0003676,GO:0005524,GO:0008026
# GO:0005515,GO:0004672,GO:0006468 	GO:0004672,GO:0005524,GO:0006468,GO:0005515
# GO:0003777,GO:0005524,GO:0008017,GO:0007018 	GO:0003777,GO:0005524,GO:0008017,GO:0007018,GO:0005515
# GO:0003682 	GO:0005515,GO:0003682
# GO:0005515,GO:0043531,GO:0007165 	GO:0043531,GO:0005515,GO:0007165
# GO:0031491,GO:0043044,GO:0003676,GO:0005524,GO:0016818,GO:0006338,GO:0005634 	GO:0003677,GO:0005524,GO:0031491,GO:0043044,GO:0003676,GO:0016818,GO:0006338,GO:0005634
# GO:0031491,GO:0043044,GO:0003676,GO:0005524,GO:0016818,GO:0006338,GO:0005634 	GO:0003677,GO:0005524,GO:0031491,GO:0043044,GO:0003676,GO:0016818,GO:0006338,GO:0005634
# GO:0005515 	GO:0000156,GO:0000160,GO:0006355,GO:0005515
# GO:0003824,GO:0006464 	GO:0006464,GO:0003824
# GO:0003824,GO:0006464 	GO:0006464,GO:0003824
# GO:0031491,GO:0043044,GO:0003676,GO:0005524,GO:0016818,GO:0006338,GO:0005634 	GO:0003677,GO:0005524,GO:0031491,GO:0043044,GO:0003676,GO:0016818,GO:0006338,GO:0005634
# GO:0003677,GO:0003887,GO:0006260 	GO:0003677,GO:0003887,GO:0006260,GO:0003676,GO:0008408,GO:0006139
# GO:0004672,GO:0005524,GO:0006468 	GO:0004672,GO:0005524,GO:0006468,GO:0005515
# GO:0004789,GO:0009228 	GO:0003924,GO:0005525,GO:0004789,GO:0009228
# GO:0043531 	GO:0043531,GO:0005515,GO:0007165
# GO:0043531 	GO:0043531,GO:0005515,GO:0007165
# GO:0005515 	GO:0004672,GO:0005524,GO:0006468,GO:0005515
# GO:0003676,GO:0005524,GO:0008026,GO:0004386 	GO:0003676,GO:0005524,GO:0008026,GO:0004386,GO:0005515
# GO:0005524,GO:0004222,GO:0006508,GO:0008270,GO:0016021 	GO:0005524,GO:0004222,GO:0006508
# GO:0005515,GO:0043531 	GO:0005515,GO:0043531,GO:0007165
# GO:0043531,GO:0005515,GO:0007165 	GO:0005515,GO:0043531,GO:0007165
# GO:0043531 	GO:0043531,GO:0005515,GO:0007165
# GO:0005515 	GO:0005515,GO:0007165
# GO:0005515 	GO:0005515,GO:0007165
# GO:0005515 	GO:0005515,GO:0007165
# GO:0043531 	GO:0043531,GO:0005515,GO:0007165
# GO:0043531 	GO:0043531,GO:0005515,GO:0007165
# GO:0043531,GO:0005515,GO:0007165 	GO:0005515,GO:0043531,GO:0007165
# GO:0043531,GO:0005515,GO:0007165 	GO:0005515,GO:0043531,GO:0007165
# GO:0005515 	GO:0003774,GO:0005524,GO:0016459,GO:0005515
# GO:0005524 	GO:0005524,GO:0046983
# GO:0016491,GO:0055114 	GO:0009055,GO:0051536,GO:0016491,GO:0055114
# GO:0043531 	GO:0043531,GO:0005515,GO:0007165

#total number of genes: 27416
#total number of splice variants: 2396
#genes without GO terms: 1101
#genes with different GO terms: 54

